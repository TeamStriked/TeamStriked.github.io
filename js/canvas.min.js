var camera2,scene2,renderer2,container,camera,scene,renderer,particles,particle,mouseX2=0,mouseY2=0,windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,SEPARATION=200,AMOUNTX=10,AMOUNTY=10,count=(SEPARATION=100,AMOUNTX=100,AMOUNTY=70,0),mouseX=85,mouseY=-342,colors=[1409143,4003200,1391744,8417813,8394040],frame=0;function getColor(e){return"hsla( hue, 80%, 50%,35% )".replace("hue",e/window.innerWidth*360+frame)}function init2(){container=document.createElement("div");var e=document.getElementById("gl");document.getElementById("home").style.height=window.innerHeight-100+"px",e.appendChild(container),(camera=new THREE.PerspectiveCamera(120,window.innerWidth/window.innerHeight,1,1e4)).position.z=1e3,scene=new THREE.Scene,particles=new Array,Math.PI;for(var n=0,o=0;o<AMOUNTX;o++)for(var t=0;t<AMOUNTY;t++){var i=colors[Math.floor(Math.random()*colors.length)],a=new THREE.ParticleCanvasMaterial({color:i,program:function(e){e.beginPath(),e.rect(0,0,1,1),e.stroke()}});(particle=particles[n++]=new THREE.Particle(a)).position.x=o*SEPARATION-AMOUNTX*SEPARATION/2,particle.position.z=t*SEPARATION-AMOUNTY*SEPARATION/2,scene.add(particle)}(renderer=new THREE.CanvasRenderer).setSize(window.innerWidth,window.innerHeight),container.appendChild(renderer.domElement),document.addEventListener("mousemove",onDocumentMouseMove,!1),document.addEventListener("touchstart",onDocumentTouchStart,!1),document.addEventListener("touchmove",onDocumentTouchMove,!1),window.addEventListener("resize",onWindowResize,!1)}function init(){var e,n,o=document.getElementById("gl2");e=document.createElement("div"),o.appendChild(e),scene2=new THREE.Scene,(renderer2=new THREE.CanvasRenderer({alpha:!0})).setSize(o.offsetWidth,o.offsetWidth/5),e.appendChild(renderer2.domElement),(camera2=new THREE.PerspectiveCamera(75,o.offsetWidth/(o.offsetWidth/5),1,1e4)).position.z=100;for(var t=2*Math.PI,i=new THREE.Geometry,a=0;a<100;a++){var r=colors[Math.floor(Math.random()*colors.length)],c=new THREE.ParticleCanvasMaterial({color:r,program:function(e){e.beginPath(),e.arc(0,0,.5,0,t,!0),e.fill()}});(n=new THREE.Particle(c)).position.x=2*Math.random()-1,n.position.y=2*Math.random()-1,n.position.z=2*Math.random()-1,n.position.normalize(),n.position.multiplyScalar(10*Math.random()+450),n.scale.x=n.scale.y=10,scene2.add(n),i.vertices.push(n.position)}var d=new THREE.Line(i,new THREE.LineBasicMaterial({color:16777215,opacity:.1}));scene2.add(d),document.addEventListener("mousemove",onDocumentMouseMove,!1),document.addEventListener("touchstart",onDocumentTouchStart,!1),document.addEventListener("touchmove",onDocumentTouchMove,!1),window.addEventListener("resize",onWindowResize,!1)}function onWindowResize(){windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2;var e=document.getElementById("gl2");camera2.aspect=e.offsetWidth/(e.offsetWidth/5),camera2.updateProjectionMatrix(),renderer2.setSize(e.offsetWidth,e.offsetWidth/5),camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight),document.getElementById("home").style.height=window.innerHeight-100+"px"}function onDocumentMouseMove(e){mouseX2=e.clientX-windowHalfX,mouseY2=e.clientY-windowHalfY,mouseX=e.clientX-windowHalfX,mouseY=e.clientY-windowHalfY}function onDocumentTouchStart(e){e.touches.length>1&&(e.preventDefault(),mouseX2=e.touches[0].pageX-windowHalfX,mouseY2=e.touches[0].pageY-windowHalfY,mouseX=e.touches[0].pageX-windowHalfX,mouseY=e.touches[0].pageY-windowHalfY)}function onDocumentTouchMove(e){1==e.touches.length&&(e.preventDefault(),mouseX2=e.touches[0].pageX-windowHalfX,mouseY2=e.touches[0].pageY-windowHalfY,mouseX=e.touches[0].pageX-windowHalfX,mouseY=e.touches[0].pageY-windowHalfY)}function checkVisible(e){var n=e.getBoundingClientRect(),o=Math.max(document.documentElement.clientHeight,window.innerHeight);return!(n.bottom<0||n.top-o>=0)}function animate(){var e=document.getElementById("gl");checkVisible(document.getElementById("gl2"))&&render(),checkVisible(e)&&render2(),requestAnimationFrame(animate),++frame}function render2(){camera.position.x+=.05*(mouseX-camera.position.x),camera.position.y+=.05*(-mouseY-camera.position.y),camera.lookAt(scene.position);for(var e=0,n=0;n<AMOUNTX;n++)for(var o=0;o<AMOUNTY;o++)(particle=particles[e++]).position.y=50*Math.sin(.3*(n+count))+50*Math.sin(.5*(o+count)),particle.scale.x=particle.scale.y=2*(Math.sin(.3*(n+count))+1)+2*(Math.sin(.5*(o+count))+1);renderer.render(scene,camera),count+=.1}function render(){camera2.position.x+=.05*(mouseX2-camera2.position.x),camera2.position.y+=.05*(400-mouseY2-camera2.position.y),camera2.position.y=Math.min(camera2.position.y,450),camera2.lookAt(scene2.position),renderer2.render(scene2,camera2)}init(),init2(),animate();